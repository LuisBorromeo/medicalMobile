
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <title></title>

    <link rel="stylesheet" href="css/jquery.mobile-1.3.1.min.css">
    <!--<link rel="stylesheet" href="themes/blue.min.css" />-->

    <!-- Extra Codiqa features -->
    <link rel="stylesheet" href="css/codiqa.ext.css">
    <link rel="stylesheet" href="css/SketchStyles.css">

    <!-- jQuery and jQuery Mobile -->
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/jquery.mobile-1.3.1.min.js"></script>

    <!-- Extra Codiqa features -->
    <script src="js/codiqa.ext.js"></script>
    <script src="js/LanguageDictionary.js"></script>

    <style>

        .bg {
            background-image: url('img/ios_notification_bg_tile.jpg')!important;
            background-color: transparent!important;
            background-attachment:scroll;
            /*background-size:100% 100%;*/
        }


        .ui-btn {
            display: block;
            text-align: center;
            cursor: pointer;
            position: relative;
            margin: .3em 0;
            padding: 0;
            height: 110px;
            line-height: 90px;
        }

        .LanguageSwitchCont {
            margin: .2em 0;
            text-align: center;
            vertical-align: middle;
        }


        .badge {
            background: #BA070F;
            color: #fff;
            padding: 2px 7px;
            position: relative;
            right: 0px;
            top: 0px;
            z-index: 999;
            border-radius: 1em;
            border: 3px solid #fff;
        }

        .mainMenu {
            display: inline-block;
            text-align: left;
            cursor: pointer;
            position: relative;
            margin: 1em 0;
            padding: 10;
            height: 50px;
            line-height: 30px;
        }

        /*------------ pain management diagram topics --------------------*/
        .anatomy {
            background-image: url('img/outline_male.png')!important;
            background-color: transparent;
            /*background-attachment:scroll;*/
            height: 600px;
            /*background-size:100% 100%;*/
            border-radius: 10px;
        }

        .painSummary {
            background-color: transparent;
            /*background-attachment:scroll;*/
            height: 600px;
            /*background-size:100% 100%;*/
            border-radius: 10px;
            padding:12px;
        }


        .topicLabel {
            color:#000000;
            /* border: 3px solid #000000; */
            text-align: center;

            display: table-cell;
            vertical-align: middle;
        }

        .headTopic{
            position: relative;
            right: -130px;
            top: 30px;

            width: 300px;
            height: 50px;

            border: 3px solid #000000;

            text-align: center;
            display: table;
        }

        .eyesTopic{
            position: relative;
            right: -225px;
            top: 30px;

            width: 110px;
            height: 30px;

            border: 3px solid #000000;

            text-align: center;
            display: table;
        }
        .leftArmTopic{
            position: relative;
            right: -55px;
            top: 160px;

            width: 110px;
            height: 400px;

            border: 3px solid #000000;

            text-align: center;
            display: table;
        }
        .btnINeed{
            display: inline-block;
            color: #ff0000;
            width: 150px;
            margin: 3px;
        }

        .yesNoCont{
            /*
            border: solid;
            border-width: 50px;
            */

        }

        .controlGroupContainer{
            border-radius: 10px;
            margin: .3em 0;
            height: 140px;
        }

    </style>
</head>
<body>
<!-- Home -->
<div data-role="page" id="page1" data-theme="a" class="bg">
    <div data-role="content">

        <div data-role="fieldcontain">
            <div class="ui-grid-b">
                <div class="ui-block-a">
                    <a data-role="button" href="#INeedPage" data-transition="slide">
                        <span id="INeed">I Need</span>
                        <span id="bubbleINeed" class='badge'>0</span>
                    </a>
                </div>
                <div class="ui-block-b">
                    <a data-role="button" href="#PainManagementPage" data-transition="slide">
                        <span id="PainManagement">Pain Management</span>
                        <span id="bubblePainManagement" class='badge'>0</span>
                    </a>
                </div>
                <div class="ui-block-c">
                    <a data-role="button" href="#page1" data-transition="slide">
                        <span id="CallForHelp">Call for Help</span>
                    </a>
                </div>
                <div class="ui-block-a">
                    <a data-role="button" href="#page1" data-transition="slide">
                        <span id="Symptoms">Symptoms</span>
                        <span id="bubbleSymptoms" class='badge'>0</span>
                    </a>
                </div>
                <div id="btnKeyboard" class="ui-block-b">
                    <a data-role="button" href="#KeyboardPage" data-transition="slide">
                        <span id="Keyboard">Keyboard</span>
                    </a>
                </div>
                <div class="ui-block-c">
                    <a data-role="button" href="#SketchBoardPage" data-transition="slide">
                        <span id="Sketchboard">Sketch Board</span>
                    </a>
                </div>
            </div>

            <div class="ui-grid-b yesNoCont">
                <div class="ui-block-a">
                    <a data-role="button" href="#page1" onclick="playaudio('/android_asset/www/audio/button-9.mp3')">
                        <span id="Yes">Yes</span>
                    </a>
                </div>
                <div class="ui-block-b">
                    <a data-role="button" href="#page1">
                        <span id="No">No</span>
                    </a>
                </div>
                <div class="ui-block-c">
                    <div class="LanguageSwitchCont">
                        <br>
                        <select name="spanishToggle" id="spanishToggle" data-theme="" data-role="slider">
                            <option value="off">
                                English
                            </option>
                            <option value="on">
                                Spanish
                            </option>
                        </select>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>

<!-- INeed -->
<div data-role="page" id="INeedPage" data-theme="a" class="bg">
    <div data-role="content">
            <div class="controlGroupContainer">
                <div data-role="controlgroup" id="INeedControlGroup" data-type="horizontal"></div>
            </div>

            <div id="INeedIcons">
                <a href="#" id="icon00" class="btnINeed" data-role="button" data-corners="true" data-inline="true">
                    <img src="icon.png">
                </a>
                <a href="#" id="icon01" class="btnINeed" data-role="button" data-corners="true" data-inline="true">
                    ico 01
                </a>
                <a href="#" id="icon02" class="btnINeed" data-role="button" data-corners="true" data-inline="true">
                    ico 02
                </a>
                <a href="#" id="icon03" class="btnINeed" data-role="button" data-corners="true" data-inline="true">
                    ico 03
                </a>
            </div>
    </div>
</div>

<!-- PainManagement -->
<div data-role="page" id="PainManagementPage" data-theme="a" class="bg">


    <div data-role="panel" id="addPainTopicPanel" data-position="right" data-display="overlay" class="ui-panel ui-panel-position-right ui-panel-display-overlay ui-body-a ui-panel-animate ui-panel-closed">

        <div data-role="fieldcontain">
            <label for="slider1">
                Pain Level
            </label>
            <input id="slider1" type="range" name="slider" value="0" min="0" max="10"
                   data-highlight="false">
        </div>
        <div data-role="fieldcontain">
            <label for="slider2">
                Pain Onset
            </label>
            <input id="slider2" type="range" name="slider" value="0" min="0" max="10"
                   data-highlight="false">
        </div>
        <div data-role="fieldcontain">
            <label for="PainType">
                Pain Type:
            </label>
            <select id="PainType" name="PainType" data-mini="true">
                <option value="Aching">
                    Aching
                </option>
                <option value="Burning">
                    Burning
                </option>
            </select>
        </div>
        <div data-role="fieldcontain">
            <label for="AggravatingFactors">
                Aggravating Factors:
            </label>
            <select id="AggravatingFactors" name="AggravatingFactors" data-mini="true">
                <option value="Breathing">
                    Breathing
                </option>
                <option value="Talking">
                    Talking
                </option>
            </select>
        </div>
        <div data-role="fieldcontain">
            <label for="AlleviatingFactors">
                Alleviating Factors:
            </label>
            <select id="AlleviatingFactors" name="AlleviatingFactors" data-mini="true">
                <option value="Cold Therapy">
                    Cold Therapy
                </option>
                <option value="Cold Therapy">
                    Heat Therapy
                </option>
            </select>
        </div>

    </div>


    <div data-role="content" class="bg">
        Pain Management

        <div class="ui-grid-a">
            <!--left grid column -->
            <div class="ui-block-a anatomy">

                <div class="headTopic" onclick="medical.toggleTopic('Head','headTopic')">
                    <span class="topicLabel">Head</span>
                </div>

                <div class="eyesTopic" onclick="medical.toggleTopic('Head','eyesTopic')">
                    <span class="topicLabel">eyes</span>
                </div>

                <div class="leftArmTopic" onclick="medical.toggleTopic('Head','eyesTopic')">
                    <a href="#addPainTopicPanel">
                        <span class="topicLabel">left arm</span>
                    </a>
                </div>

            </div>

            <!--right grid column-->
            <div class="ui-block-b painSummary">


                Summary of pain here


            </div>
        </div>

        <a data-role="button" href="#page1" data-transition="slide" class="mainMenu">
            Main Menu
        </a>

    </div>
</div>

<!-- Keyboard -->
<div data-role="page" id="KeyboardPage" data-theme="a" class="bg">
    <div data-role="content">
        <div  data-role="fieldcontain">
            <textarea  id="txtKeyboard" placeholder=""></textarea>
        </div>


        <div class="ui-block-a">
            <a id="btnClearKeyboardText" data-role="button">
                <span id="ClearText">Clear</span>
            </a>
        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

            <div data-role="navbar" data-iconpos="left">
                <ul>
                    <li>
                        <a href="#page1" data-transition="slide" data-theme="" data-icon="home">

                        </a>
                    </li>
                </ul>
            </div>

        </div>


    </div>
</div>

<!-- Sketch board -->
<div data-role="page" id="SketchBoardPage" data-theme="a" class="bg">
    <div data-role="content">

        <div id="canvasContainer" >
            <canvas id="signature" height="600"/>
        </div>

        <div class="ui-block-a">
            <a id="btnReset" data-role="button">
                <span id="Reset">Reset</span>
            </a>
        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

            <div data-role="navbar" data-iconpos="left">
                <ul>
                    <li>
                        <a href="#page1" data-transition="slide" data-theme="" data-icon="home">

                        </a>
                    </li>
                </ul>
            </div>

        </div>


    </div>
</div>

<audio id="soundHandle" style="display: none;" />


<script type="text/javascript" src="phonegap.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script src="js/modernizr.custom.34982.js"></script>
<script src="js/signatureCapture.js"></script>
<script src="js/Topic.js"></script>
<script>
    var sigCapture = null;
    //var buttonSound = null;

    var medical = {
        init : function(){
            console.log("init fired");

            //---------------------- Set Topic Categories ------------------
            medical.TopicCategories[0]  = new TopicCategory( "Head", "blah" );
            medical.TopicCategories[0].AddTopic( new Topic("headTopic") );
            medical.TopicCategories[0].AddTopic( new Topic("eyesTopic") );
            medical.TopicCategories[0].AddTopic( new Topic("earsTopic") );


            //---------------------- register events -----------------------
            $( "#spanishToggle" ).bind( "change", function(event, ui) {
                console.log("Spanish " + event.target.value);

                if (event.target.value == "on"){
                    medical.parseLanguage("spanish");
                } else {
                    medical.parseLanguage("english");
                }

            });


            //event : entering the keyboard page
            $( document ).on( "pageinit", "#KeyboardPage", function( event ) {
                console.log("focus...");

            });

            //event : entering the sketch page
            $( document ).on( "pageinit", "#SketchBoardPage", function( event ) {
                /*
                 if (sigCapture == null){
                 sigCapture = new SignatureCapture( "signature" );
                 }
                 */
            });

            //global button handler. Fires for all buttons
            $( document ).on( "click", ".ui-btn", function( event, ui ) {
                console.log("button click");

                /*
                 jQuery play sound.
                 var soundHandle = document.getElementById('soundHandle');
                 soundHandle.src = 'button-9.mp3';
                 soundHandle.play();
                 */

                //var my_media = new Media("/android_asset/www/button-9.mp3");
                //my_media.play();
            });

            //icon buttons with css class btnINeed assigned to them
            $( document ).on( "click", ".btnINeed", function( event, ui ) {
                console.log("I need icon clicked");

                medical.moveToControlGroup(event.currentTarget, $("#INeedControlGroup"), $("#INeedIcons") );
                var bubbleCount = $(".ui-controlgroup-controls").children().length;

                $("#bubbleINeed").text(bubbleCount);

            });

            //Specific buttons
            $( document ).on( "click", "#btnReset", function( event, ui ) {
                medical.clearSketch();
            });

            $( document ).on( "click", "#btnClearKeyboardText", function( event, ui ) {
                medical.clearKeyboardText();
            });


            //buttonSound = new Media("/www/button-9.mp3", function(){}, function(){});
            //buttonSound.play();

        },

        /*------------------ Initialize Properties ------------------*/

        TopicCategories: [],

        /*------------------ Methods ------------------*/

         moveToControlGroup: function (sourceElement, startElement, destinationElement){

             var srcParentId = $(sourceElement).parent().parent()[0].id;
             var targetElement1Id = $(startElement)[0].id;

             if (srcParentId == targetElement1Id){

                 var cg = destinationElement.find(".ui-controlgroup-controls");

                 if (cg.length > 0) {
                     cg.append(sourceElement);
                     destinationElement.controlgroup( "refresh" );
                 } else {
                     destinationElement.append(sourceElement);
                 }

             } else {

                 var cg = startElement.find(".ui-controlgroup-controls");

                 if (cg.length > 0) {
                     cg.append(sourceElement);
                     startElement.controlgroup( "refresh" );

                 } else {
                     startElement.append(sourceElement);
                 }

             }
         },

        parseLanguage : function( languageName ){
            console.log("parsing language");

            $.each(dictionary, function(i, v) {
                if (v.Language == languageName) {
                    var targetSpan = $("#" + v.Key);
                    targetSpan.text( v.Text );
                }
            });

        },

        clearKeyboardText : function(){
            $("#txtKeyboard").val('').select();
        },

        clearSketch : function(){
            sigCapture.clear();
        },

        toggleTopic : function( categoryName, topicName ){

            var curCat = medical.getCategory(categoryName);

            if (curCat != null){

                var curTopic = medical.getTopic( curCat, topicName);

                if (curTopic != null){
                    curTopic.Toggle();
                }

                //refresh counts.
                $("#bubblePainManagement").text( curCat.CategoryCount() );
            }
        },

        getCategory : function( categoryName ){
            var curCat = null;

            $.each(medical.TopicCategories, function(i, v) {
                console.log("recursing cats:" + medical.TopicCategories[i].CategoryName);

                if ( medical.TopicCategories[i].CategoryName == categoryName) {
                    console.log("found cat:" + categoryName);
                    curCat = medical.TopicCategories[i];
                }
            });

            return curCat;
        },

        getTopic : function ( category, topicName ){
            var curTopic = null;

            $.each(category.Topics, function(i, v) {
                console.log("recursing topics:" + category.Topics[i].TopicId);

                if ( category.Topics[i].TopicId == topicName) {
                    console.log("found topic:" + topicName);
                    curTopic = category.Topics[i];
                }
            });

            return curTopic;
        }
    };

    (function( $ ) {

        $(document).ready(function(){
            medical.init();

            //signature
            sigCapture = new SignatureCapture( "signature" );

        });

    })( jQuery );

</script>
<script type="text/javascript">
    app.initialize();
</script>

</body>
</html>


